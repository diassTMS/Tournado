{% load render_table from django_tables2 %}
<div class="overflow-auto" id="order_container">
    {% if orders.data|length == 0 %}
        {% render_table orders %}
        <small class="text-muted" style="float:center;">
            <i>None</i>  
        </small>
    {% else %}
        {% render_table orders %}
    {% endif %}
    <hr>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script>
    $('.delete_button').click(function (evt) {
        evt.preventDefault();
        const btn = $(this);
        const url = btn.attr('data-href');
        $.ajax({
            method: 'GET',
            url: url,
            dataType: 'json',

            success: function (data) {
                $('#order_container').html(data.result)
            }
        })
    });

    $('.invoice_button').click(function (evt) {
        evt.preventDefault();
        const btn = $(this);
        const pk = btn.attr('pk');
        const season = document.getElementById("season").value;  // get season at the time of click
        const userId = '{{ userInput.id }}';

        $.ajax({
            method: 'GET',
            dataType: 'json',
            url: `/invoice/${pk}/`,
            data: { season: season,
                    userId: userId,
                },   // send the selected season
            success: function (data) {
                $('#order_container').html(data.table);
                $('#entries').text("No. Entries = " + data.entries);
                $('#owing').text("Uninvoiced = £" + data.owing);
                $('#invoiced').text("Invoiced = £" + data.invoiced);
                $('#total').text("Total = £" + data.total);
            }
        });
    });
</script>